<!DOCTYPE html>
<html lang="en">

{% extends "base.html" %}

{% load static %}
{% block search %}
    <!-- Topbar Search -->
  <form class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
    <div class="input-group">
      <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..." aria-label="Search" aria-describedby="basic-addon2">
      <div class="input-group-append">
        <button class="btn btn-primary" type="button">
          <i class="fas fa-search fa-sm"></i>
        </button>
      </div>
    </div>
  </form>
{% endblock %}

{% block container %}
    {% load leaflet_tags %}
    {% leaflet_css plugins="ALL" %}
    {% leaflet_js plugins="ALL" %}

    <div>
        {% leaflet_map "main" callback="map_init" %}
    </div>

    <div id="mapid">
        <style>
        .leaflet-container {width: 100%; height: 600px}
        </style>
        <script type="text/javascript">
            function map_init(map, options) {
                {% for feacture in feactures %}
                    var method = ''
                    {% for feac in feacture %}
                        // get point lat and lon
                        var lat = "{{ feac.samplingfeatureid.featuregeometrywkt.x }}";
                        var lon = "{{ feac.samplingfeatureid.featuregeometrywkt.y }}";
                        // zoom to point & add it to map
                        var name = '<h6>{{ feac.samplingfeatureid.samplingfeaturename }}</h6>'
                        var la = '<br>Lat: {{ feac.samplingfeatureid.featuregeometrywkt.x }}</br>'
                        var lo = '<br>Lon: {{ feac.samplingfeatureid.featuregeometrywkt.y }}</br>'
                        var method = method + '<h6><a href="{%  url 'results' feac.featureactionid %}">{{ feac.action.method.methodname }}</a></h6>\n'
                    {% endfor %}
                    L.marker([lat, lon]).bindPopup(name+method+la+lo).openPopup().addTo(map);
                {% endfor %}
            }
        </script>
    </div>
{% endblock %}